<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.spring.masinsa.mapper.MaskMapper">
  
  <select id="getAllImages" resultMap="getAllImagesOb">
    SELECT * FROM image WHERE mask_id = #{maskId};
  </select>

  <resultMap id="getAllImagesOb" type="Image">
  	<id column="image_id" property="id" />
  	<result column="image_url" property="imageUrl" />
  	<result column="image_type" property="imageType" />
  	<collection property="mask" ofType="Mask">
  		<id column="mask_id" property="id" />
  	</collection>
 </resultMap>
 
  <select id="getAllMask" resultMap="getAllMaskInfo">
    SELECT * FROM mask WHERE 1=1
   	<if test="blockingIndex != null">
   		AND blocking_index = #{blockingIndex}
   	</if>
   	<if test="size != null">
   		AND size = #{size}
   	</if>
   	<if test="shape != null">
   		 AND shape = #{shape}
   	</if>
  </select>

  <select id="getSortedMasks" resultMap="getAllMaskInfo">
    SELECT * FROM mask ORDER BY #{standard} ASC;
  </select>
  
	<!-- 예시 : SELECT * FROM mask 
	WHERE size = "대형" AND shape = "새부리형" 
	ORDER BY price desc limit 2 offset 0; -->
	<select id="FilterSortMaskByPage" resultMap="getAllMaskInfo">
		SELECT * FROM mask
		<where>
			<if test="filterCol1 != null and filter1 != null">
				${filterCol1} = #{filter1}
			</if>
			<if test="filterCol2 != null and filter2 != null">
				AND ${filterCol2} = #{filter2}
			</if>
			<if test="filterCol3 != null and filter3 != null">
				AND ${filterCol3} = #{filter3}
			</if>
		</where>
		<if test="sortCol != null and order != null">
			ORDER BY ${sortCol} ${order}
		</if>
		<if test="limit != null">
			LIMIT #{limit}
			<if test="offset != null">
				OFFSET #{offset}
			</if>
		</if>
		;
	</select>


		<!-- SELECT * FROM mask
		<where>
			<if test="filterCol1 != null or filter1 != null">
				${filterCol1} = #{filter1}
			</if>
			<if test="filterCol2 != null or filter2 != null">
				AND ${filterCol2} = #{filter2}
			</if>
			<if test="filterCol3 != null or filter3 != null">
				AND ${filterCol3} = #{filter3}
			</if>
		</where>
		<if test="sortCol != null and order != null">
			ORDER BY ${sortCol} ${order}
		</if>
		<if test="limit != null and offset != null">
			LIMIT #{limit} , #{offset}
		</if>
		; -->

  <!-- <resultMap id="getAllMaskInfo" type="Mask"> -->
  <resultMap id="getAllMaskInfo" type="com.spring.masinsa.entity.Mask">
  	<id column="mask_id" property="id" />
  	<result column="mask_name" property="name" />
  	<result column="size" property="size" />
  	<result column="price" property="price" />
  	<result column="blocking_index" property="blockingIndex" />
  	<result column="shape" property="shape" />
  	<result column="thumbnail_image_url" property="thumbnail" />
  	<result column="purchase_url" property="purchaseUrl" />
  	<result column="click_num" property="click" />
  	<result column="soldout_status" property="soldout" />
  	<result column="avg_score" property="avgScore" />
  </resultMap>
  	
</mapper>